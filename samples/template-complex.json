{
  "templateId": "complex_welding_v2",
  "templateName": "Precision Welding Job (AWS D1.1)",
  "description": "Advanced welding process with parameters, variables, and conditional stages",
  "version": "2.1.0",
  "parameters": [
    {
      "parameterId": "plateQuantity",
      "label": "Steel Plate Quantity",
      "defaultValue": 10,
      "description": "Number of steel plates to weld"
    },
    {
      "parameterId": "weldingType",
      "label": "Welding Type",
      "defaultValue": "MIG",
      "description": "Type of welding process (MIG, TIG, or Stick)"
    },
    {
      "parameterId": "certLevel",
      "label": "Required Certification Level",
      "defaultValue": "AWS D1.1",
      "description": "AWS certification level required for this job"
    },
    {
      "parameterId": "materialGrade",
      "label": "Steel Grade",
      "defaultValue": "A36",
      "description": "ASTM steel grade specification"
    },
    {
      "parameterId": "clientPO",
      "label": "Client Purchase Order",
      "defaultValue": "",
      "description": "Client's purchase order number"
    }
  ],
  "variables": [
    {
      "variableId": "temperature",
      "label": "Weld Temperature",
      "defaultValue": 0,
      "description": "Current welding temperature in Celsius"
    },
    {
      "variableId": "defectCount",
      "label": "Defect Count",
      "defaultValue": 0,
      "description": "Number of defects found during inspection"
    },
    {
      "variableId": "passedInspection",
      "label": "Passed QA Inspection",
      "defaultValue": false,
      "description": "Whether the job passed quality inspection"
    }
  ],
  "stages": [
    {
      "stageId": "prep",
      "stageName": "Preparation",
      "order": 1,
      "dependencies": [],
      "condition": "succeeded()",
      "steps": [
        {
          "stepId": "material_check",
          "stepName": "Material Inspection - ${plateQuantity} ${materialGrade} plates",
          "description": "Verify ${plateQuantity} steel plates (Grade ${materialGrade}) meet ASTM specifications",
          "order": 1,
          "dependencies": [],
          "requirements": [
            "Steel Plate Grade ${materialGrade} (${plateQuantity} sheets)",
            "Digital Micrometer (0.001mm accuracy)",
            "Digital Scale",
            "Material Certificate (PDF)"
          ],
          "checklist": [
            "Material dimensions verified",
            "No surface defects found",
            "Proper storage conditions confirmed",
            "Material certificates reviewed"
          ]
        },
        {
          "stepId": "equipment_setup",
          "stepName": "Setup ${weldingType} Welding Equipment",
          "description": "Prepare and calibrate ${weldingType} welder according to WPS",
          "order": 2,
          "dependencies": [],
          "requirements": [
            "${weldingType} Welder 300A",
            "Welding Procedure Specification (WPS)",
            "Calibration tools",
            "Safety equipment"
          ],
          "checklist": [
            "Equipment cleaned and inspected",
            "Calibration verified and documented",
            "Safety check completed",
            "WPS parameters set correctly"
          ]
        }
      ]
    },
    {
      "stageId": "welding",
      "stageName": "Welding Operations",
      "order": 2,
      "dependencies": ["prep"],
      "condition": "succeeded()",
      "steps": [
        {
          "stepId": "weld_primary",
          "stepName": "Primary ${weldingType} Welding - PO: ${clientPO}",
          "description": "Execute welding per WPS using ${weldingType} process. Record temperature: ${temperature}°C",
          "order": 1,
          "dependencies": ["material_check", "equipment_setup"],
          "requirements": [
            "AWS Welding Certification ${certLevel}",
            "Welding Wire ER70S-6 (5 kg)",
            "Shielding Gas 75% Argon / 25% CO2 (2 cylinders)",
            "Temperature Data Logger",
            "Safety gear"
          ],
          "checklist": [
            "Pre-weld inspection completed",
            "WPS parameters verified",
            "All ${plateQuantity} plates welded",
            "Temperature log maintained: ${temperature}°C",
            "Visual inspection passed",
            "Weld quality meets standards"
          ]
        }
      ]
    },
    {
      "stageId": "qa",
      "stageName": "Quality Assurance",
      "order": 3,
      "dependencies": ["welding"],
      "condition": "succeeded()",
      "steps": [
        {
          "stepId": "qa_inspection",
          "stepName": "NDT Inspection & Dimensional Check",
          "description": "Non-destructive testing and dimensional verification. Found ${defectCount} defects so far.",
          "order": 1,
          "dependencies": ["weld_primary"],
          "requirements": [
            "NDT Level II Inspector (UT/MT)",
            "Ultrasonic Testing Equipment",
            "Magnetic Particle Testing Equipment",
            "Inspection Acceptance Criteria",
            "Measuring tools"
          ],
          "checklist": [
            "UT inspection completed",
            "MT inspection completed",
            "Dimensional checks passed",
            "Defect count recorded: ${defectCount}",
            "Inspection report completed",
            "QA Manager sign-off obtained"
          ]
        }
      ]
    },
    {
      "stageId": "rework",
      "stageName": "Rework (Conditional - If Failed)",
      "order": 4,
      "dependencies": ["qa"],
      "condition": "failed()",
      "steps": [
        {
          "stepId": "rework_weld",
          "stepName": "Corrective Welding - Rework",
          "description": "Address ${defectCount} defects identified during QA inspection",
          "order": 1,
          "dependencies": ["qa_inspection"],
          "requirements": [
            "AWS Welding Certification ${certLevel}",
            "Rework Authorization",
            "Non-Conformance Report (NCR)",
            "Welding equipment"
          ],
          "checklist": [
            "NCR reviewed and approved",
            "Root cause identified",
            "Corrective actions documented",
            "All ${defectCount} defects addressed",
            "Rework completed per WPS"
          ]
        },
        {
          "stepId": "rework_inspection",
          "stepName": "Re-inspection After Rework",
          "description": "Verify rework meets acceptance criteria",
          "order": 2,
          "dependencies": ["rework_weld"],
          "requirements": [
            "NDT Level II Inspector",
            "Testing equipment",
            "Acceptance criteria"
          ],
          "checklist": [
            "Re-inspection completed",
            "All defects resolved",
            "Final QA approval obtained"
          ]
        }
      ]
    },
    {
      "stageId": "cleanup",
      "stageName": "Cleanup & Documentation (Always Runs)",
      "order": 5,
      "dependencies": ["qa", "rework"],
      "condition": "always()",
      "steps": [
        {
          "stepId": "cleanup_workspace",
          "stepName": "Clean and Store Equipment",
          "description": "Clean work area, store equipment, dispose of waste properly",
          "order": 1,
          "dependencies": [],
          "requirements": [
            "Waste disposal containers",
            "Cleaning supplies",
            "Storage area access"
          ],
          "checklist": [
            "Work area cleaned",
            "Equipment stored properly",
            "Waste disposed per regulations",
            "Tools returned to storage",
            "Area inspected and approved"
          ]
        },
        {
          "stepId": "finalize_docs",
          "stepName": "Finalize Job Documentation",
          "description": "Compile all documentation for client PO ${clientPO}",
          "order": 2,
          "dependencies": ["cleanup_workspace"],
          "requirements": [
            "Job Traveler Packet",
            "All inspection reports",
            "Certificates and logs"
          ],
          "checklist": [
            "All required documents present",
            "Documents signed and dated",
            "Digital copies uploaded",
            "Physical copies filed",
            "Client PO ${clientPO} referenced in all docs",
            "Final inspection: Passed=${passedInspection}, Defects=${defectCount}"
          ]
        }
      ]
    }
  ],
  "createdAt": "2025-11-04T00:00:00Z",
  "createdBy": "system"
}
